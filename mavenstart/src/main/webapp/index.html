<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ULTIMATE TODO LIST</title>
    <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/pure-min.css"
          integrity="sha384-cg6SkqEOCV1NbJoCu11+bm0NvBRc8IYLRGXkmNrqUBfTjmMYwNKPWBTIKyw9mHNJ" crossorigin="anonymous">
</head>
<body>
<h1>
    <form id="welcomeForm" class="pure-form" style=" text-align:center">

        <input type="text" class="pure-input-rounded" name="name" placeholder="name"/>
        <!--zeby pokazywaÅ‚o sie na szaro w podpowiedz co mamy wpisac dodajmey placeholder -->

        <fieldset id="langs"></fieldset>

        <!--Å¼eby checkboxy sie odznaczaÅ‚y ze tylko jeden moze byc wcisniety to musza
        miec ten same name-->


        <button id="btn" class="pure-button pure-button pure-button-active ">Submit</button>
        <!--id musi byc uniklane-->
    </form>

    <div id="welcome" class="pure-form" style=" text-align:center"></div>
</h1>


<script>
    const API_URL = 'http://localhost:8080/api';
    const CODE_TO_EMOJI = {
        'pl': 'ðŸ‡µðŸ‡±',
        'en': 'ðŸ‡ºðŸ‡¸',
        'de': 'ðŸ‡©ðŸ‡ª',
        'hr': 'ðŸ‡­ðŸ‡·'
    };

    fetch(`${API_URL}/langs`)
        .then(response => response.json())
            .then((langArr) => {
                const checkboxes = langArr.map(lang => `
                <label class="pure-radio">
            <input type="radio" name="lang" value="${lang.id}"/>
            ${CODE_TO_EMOJI[lang.code]}
            </label>
                `).join('\n');
                document.getElementById('langs').innerHTML = checkboxes;
            });

    const div = document.getElementById('welcome');
    const form = document.getElementById('welcomeForm');
    document.getElementById('btn').addEventListener('click', (event) => {
        event.preventDefault(); //blokowanie tego ze nam samo uzupelnialo query stringa
        const nameFromForm = form.elements.name.value;
        const language = form.elements.lang.value;
        const formObject = {
            name: nameFromForm,
            lang: language
        };


        fetch(`${API_URL}?${new URLSearchParams(formObject)}`)
            .then((response) => {
                return response.text();
            }).then((text) => {
            div.innerHTML = `
                <h2>${text}</h2>
                `;

        });
        //zabezpiecznie przed wstrzykoiwaniem pozdapytan sql URLSearchParams
    });
</script>
</body>
</html>